<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafit.pjt.model.dao.StoreDao">

	<!-- 메인화면 카테고리 조회 (8개) -->	
	<select id="selectCategory" resultType="Category">
		SELECT *
		FROM exercise_category
		LIMIT 8;
	</select>
	
	<!-- 필터별 store 리스트 -->
	<select id="selectStoreById" parameterType="int" resultType="Store">
		SELECT *
		FROM stores
		WHERE id = #{id}
	</select>
	
	<!-- 필터별 store 리스트 -->
	<select id="selectStore" parameterType="SearchCondition" resultType="Store">
		SELECT *
		FROM stores
		<where>
			<if test="key != 'none'">
				AND ${key} LIKE concat ('%', #{word}, '%')
			</if>
			<if test="category != 'none'">
				AND exerciseId IN (
                	SELECT exercise_id
                	FROM exercise_category
                	WHERE category = #{category}
            		)
			</if>		
		</where>
		<if test="orderBy != 'none'">
			ORDER BY ${orderBy} ${orderByDir}
		</if>
	</select>
	
	<update id="updateStore" parameterType="store">
	    UPDATE stores
	    <set>
	        store_name = #{storeName},
	        address = #{address},
	        phone_number = #{phoneNumber},
	        description = #{description},
	        opening_hours = #{opening_hours},
	        logo_image = #{logoImage},
	        exercise_id = #{exerciseId}
	    </set>
	    WHERE store_id = #{storeId}
	</update>

</mapper>